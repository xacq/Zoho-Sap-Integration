<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>

  <connectionStrings>
    <!--
      Cadena de conexión al SQL Server donde vive la tabla de idempotencia Z_SOHO_OrderMap.
      IMPORTANTE: Este servidor también debe tener acceso a la base de datos de SAP (para PreValidación).
      En la mayoría de instalaciones SAP B1, la BD de SAP y la BD de integración
      están en el mismo SQL Server, por lo que la misma connection string sirve para ambas.
    -->
    <add name="DefaultConnection"
         connectionString="Server=TU_SERVIDOR_SQL;Database=TU_BD_INTEGRACION;User Id=TU_USUARIO;Password=TU_PASSWORD;Connection Timeout=30;"
         providerName="System.Data.SqlClient"/>
  </connectionStrings>

  <appSettings>
    <!-- ============================================================
         CONFIGURACIÓN DE SEGURIDAD
         ============================================================ -->
    <!--
      Clave de autenticación que Zoho/Soho debe enviar en el header X-API-KEY.
      Si se deja vacío, NO se valida la clave (útil solo para pruebas locales).
      En producción, establecer una clave segura.
    -->
    <add key="Soho.ApiKey" value="CAMBIAR_POR_CLAVE_SEGURA"/>

    <!-- ============================================================
         CONFIGURACIÓN DEL SERVIDOR HTTP EMBEBIDO
         ============================================================ -->
    <!--
      Puerto en el que el integrador escucha las solicitudes HTTP entrantes.
      Zoho/Soho debe apuntar a http://TU_SERVIDOR:8080/orders
    -->
    <add key="Http.Port" value="8080"/>

    <!--
      Prefijo de escucha del HttpListener. Cambiar el puerto si es necesario.
      Para escuchar en todas las interfaces usar http://+:8080/
      Para solo localhost usar http://localhost:8080/
    -->
    <add key="Http.Prefix" value="http://+:8080/"/>

    <!-- ============================================================
         VALORES POR DEFECTO DE MAPEO SAP
         ============================================================ -->
    <!--
      CardCode del cliente genérico/default en SAP al que se asignarán los pedidos.
      Debe existir en la tabla OCRD de SAP Business One.
    -->
    <add key="Soho.DefaultCardCode" value="CLI_SOHO"/>

    <!--
      Código numérico del vendedor (SlpCode) por defecto en SAP.
      Debe existir en la tabla OSLP de SAP Business One.
    -->
    <add key="Soho.DefaultSlpCode" value="1"/>

    <!--
      Código del almacén por defecto en SAP.
      Debe existir en la tabla OWHS de SAP Business One.
    -->
    <add key="Soho.DefaultWarehouseCode" value="01"/>

    <!-- ============================================================
         CONFIGURACIÓN DE SAP DI API
         ============================================================ -->
    <!--
      IP o nombre del servidor SAP Business One (donde corre el SQL Server de SAP).
      Para SAP HANA incluir el puerto: 192.168.1.100:30015
    -->
    <add key="SapDi.Server" value="192.168.1.100"/>

    <!--
      Tipo de base de datos de SAP. Opciones:
        dst_MSSQL2008, dst_MSSQL2012, dst_MSSQL2014, dst_MSSQL2016, dst_MSSQL2017, dst_HANADB
    -->
    <add key="SapDi.DbServerType" value="dst_MSSQL2016"/>

    <!-- Nombre de la base de datos (empresa) en SAP Business One -->
    <add key="SapDi.CompanyDb" value="NOMBRE_EMPRESA_SAP"/>

    <!-- Usuario y contraseña del SQL Server (para la DI API) -->
    <add key="SapDi.DbUser" value="sa"/>
    <add key="SapDi.DbPassword" value="TU_PASSWORD_SQL"/>

    <!-- Usuario y contraseña de SAP Business One (usuario de aplicación) -->
    <add key="SapDi.UserName" value="manager"/>
    <add key="SapDi.Password" value="TU_PASSWORD_SAP"/>

    <!--
      Servidor de licencias SAP. Formato: IP:40000
      Si está en el mismo servidor que SAP, usar la misma IP.
    -->
    <add key="SapDi.LicenseServer" value="192.168.1.100:40000"/>

    <!-- ============================================================
         CONFIGURACIÓN DE BASE DE DATOS SAP (Para Pre-validación)
         Nombre de la BD de SAP para consultas directas SQL de validación.
         Si la tabla Z_SOHO_OrderMap está en la misma BD de SAP, usar ese nombre.
         Si está en BD separada, ajustar las consultas en OrderMapRepository.cs
         ============================================================ -->
    <add key="SapDi.SapDatabase" value="NOMBRE_EMPRESA_SAP"/>

    <!-- ============================================================
         CONFIGURACIÓN DE LOGGING
         ============================================================ -->
    <!-- Directorio donde se guardan los archivos de log -->
    <add key="Log.Directory" value="C:\SohoSapIntegrator\Logs"/>

    <!-- Nivel mínimo de log: DEBUG, INFO, WARN, ERROR -->
    <add key="Log.Level" value="INFO"/>

    <!-- ============================================================
         CONFIGURACIÓN DE SERVICIO WINDOWS
         ============================================================ -->
    <!-- Nombre del servicio Windows cuando se instala como servicio -->
    <add key="Service.Name" value="SohoSapIntegrator"/>
    <add key="Service.DisplayName" value="Soho SAP Integrador - Pedidos"/>
    <add key="Service.Description" value="Recibe pedidos de Soho/Zoho via HTTP y los crea en SAP Business One"/>
  </appSettings>
</configuration>
